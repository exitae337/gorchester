env: "development"
listen_addr: ":8080"
data_dir: "./test-data"
cluster_name: "dev-cluster"

services:
  - service_name: "test-web"
    image: "nginx:alpine"
    replicas: 2
    ports:
      - host_port: 8081
        container_port: 80
        protocol: "tcp"
    resources:
      cpu_millicores: 50
      memory_bytes: 67108864  
    scale_policy:
      min_replicas: 1
      max_replicas: 3
      target_cpu: 70.0
      cooldown_seconds: 60
    health_check:
      type: "http"
      http_path: "/"
      port: 80
      interval: 10s
      timeout: 5s
      retries: 3

  - service_name: "test-cache"
    image: "redis:alpine"
    replicas: 1
    ports:
      - host_port: 6379
        container_port: 6379
        protocol: "tcp"
    resources:
      cpu_millicores: 30
      memory_bytes: 33554432  # 32MB
    health_check:
      type: "tcp"
      port: 6379
      interval: 15s
      timeout: 5s
      retries: 3

  - service_name: "echo-service"
    image: "busybox:latest"
    replicas: 1
    command:
      - "sh"
      - "-c"
      - "echo 'Test service running' && sleep 3600"
    resources:
      cpu_millicores: 10
      memory_bytes: 16777216 
    health_check:
      type: "command"
      command: ["echo", "healthy"]
      interval: 30s
      timeout: 5s
      retries: 2